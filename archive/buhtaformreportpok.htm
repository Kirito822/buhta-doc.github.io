<!DOCTYPE HTML>
<html>
<head>
   <title>Настройка бухгалтерской и статистической отчетности</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "buhtaformreportpok.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#C0C0C0">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <p style="text-indent: 0px;"><span style="font-size: 12pt; font-weight: bold;">Настройка бухгалтерской и статистической отчетности</span></p>

    </td>
    <td style="text-align:right">
     <a href="mainpage20161026.htm">Top</a>&nbsp;
     <a href="script_error.htm">Previous</a>&nbsp;
     <a href="import_online.htm">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p style="text-align: center; text-indent: 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px;"><span style="font-size: 12pt; font-weight: bold;">Получение и отображение в отчетах данных из составленных ранее отчетов</span> </p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Среди многообразия отчетных форм, представленных в комплексе БУХта, есть отчеты, данные которых частично совпадают с данными других, уже составленных отчетов. См. раздел <a href="buhtaform.htm" class="topiclink">Конфигурация ''BuhtaForm''</a> </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Например, в отчете «Отчет о движении денежных средств» графа 3 включает данные за отчетный период, а графа 4 – данные за аналогичный период предыдущего года, т.е. данные для графы 4 можно взять из графы 3 «Отчета о движении денежных средств» за аналогичный период предыдущего года, если этот отчет был составлен и сохранен в архиве. </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px; margin: 0px 0px 0px 47px;"><img src="pok1.jpg" width="643" height="340" alt="pok1" style="border:none" /></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">А в отчете «Сведения о финансовом состоянии организации» (форма статистического наблюдения П-3) некоторые данные совпадают с данными отчетов «Бухгалтерский баланс» и «Отчет о прибылях и убытках» за тот же период. Т.о., при составлении отдельных отчетов часть данных можно не собирать заново, а взять из составленных и сохраненных отчетов. Такой подход тем более удобен, что, как показывает практика, данные в уже составленных отчетах зачастую корректируются вручную, и желательно, чтобы эти корректировки были учтены при составлении новых отчетов.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">В первых вариантах режимов составления отчетов «Отчет о движении денежных средств» и «Отчет о прибылях и убытках» предлагалось из Архива составленных отчетов выбрать отчет, в котором содержатся данные за предшествующий период. Но это оказалось неудобным, поскольку в архиве может храниться много отчетов, составленных по одному и тому же шаблону за один и тот же период, и трудно определить, какой из них – окончательный вариант отчета. Вот почему возникла необходимость в Таблице, в которой хранились бы показатели из уже составленных отчетов, причем показатели только одного из всех отчетов, составленных по одному и тому же шаблону за один и тот же период по одному юридическому лицу. Именно с этой целью в БУХте добавлена таблица [_Показатели архивных отчетов].</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Данные в таблицу [_Показатели архивных отчетов] записываются при создании и изменении отчетов по шаблону второго типа MS Excel, если в шаблоне отчета есть лист «Показатели» строго определенной структуры. </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px; margin: 0px 0px 0px 13px;"><img src="pok2.jpg" width="773" height="392" alt="pok2" style="border:none" /></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Первые три строки этого листа – заголовок: первая и вторая строка содержат названия и значения общих сведений об отчете - краткое название формы, номер юридического лица, в котором создан отчет, период, за который составляется отчет, дату начала и дату конца этого периода, единицу измерения показателей отчета, название шаблона отчета. Третья строка – заголовок списка показателей, с четвертой строки начинается список показателей, в котором содержатся сведения для выгрузки данных отчета в таблицу [_Показатели архивных отчетов]: номер раздела, номер строки, номер графы, название листа, адрес ячейки (указываются название и полный адрес) и сумма – значение показателя. После создания отчета и сохранения его в Архиве отчетов на экране появляется сообщение-запрос – сохранять ли данные отчета в таблицу [_Показатели архивных отчетов].</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px; margin: 0px 0px 0px 47px;"><img src="pok3.jpg" width="432" height="151" alt="pok3" style="border:none" /></p>
<p style="text-align: center; text-indent: 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Если подтверждение получено, то предварительно из таблицы [_Показатели архивных отчетов] удаляются все показатели, у которых:</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- значение поля «Форма» совпадает с кратким названием формы, указанном на листе «Показатели», </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- поле «Дата начала» совпадает со значением в ячейке «Дата начала» и поле «Дата конца» совпадает со значением в ячейке «Дата конца» на листе «Показатели», </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- значение в поле «Шаблон» совпадает с шаблоном, указанном на листе «Показатели», </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- поле «Юр.лицо» совпадает с текущим юр.лицом. </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">После этого в таблицу заносятся показатели из сохраненного отчета, каждому показателю соответствует одна строка листа «Показатели», начиная с четвертой строки: поля «Форма», «Юр.лицо», «Дата начала», «Дата конца», «Шаблон», «Период» заполняются значениями, указанными в заголовке листа «Показатели» в строке 2, в поле «Ключ отчета» заносится ссылка на сохраненный в архив отчет, в поле «Единица измерения» попадает значение из 8-го столбца («Н») соответствующей строки листа «Показатели», если же ячейка пуста, то - значение из шапки листа «Показатели» (строка 2, столбец 6), в поля «Код строки», «Графа», «Раздел», «Sheet», «Range», «Cell», «Сумма» заносятся значения из ячеек соответствующей строки листа «Показатели».</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px;"><img src="pok4.jpg" width="950" height="346" alt="pok4" style="border:none" /></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Впоследствии, при изменении отчета, данные которого уже сохранены в таблице [_Показатели архивных отчетов], все старые данные будут удалены из Таблицы и добавлены заново в соответствии со значениями на листе «Показатели» (без вопроса пользователю). Можно принудительно сохранить показатели отчета в таблице – из списка отчетов в Архиве составленных отчетов по F12 вызвать форму [Стандартная. Сохранение показателей отчета]</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px;"><img src="pok5.jpg" width="700" height="335" alt="pok5" style="border:none" /></p>
<p style="text-align: center; text-indent: 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">В каждом новом шаблоне, показатели которого должны быть сохранены в таблице [_Показатели архивных отчетов], следует создать лист «Показатели» и заполнить его. Три первых строки листа «Показатели» заполняются вручную – копированием трех строк такого же листа из стандартных шаблонов и заменой значений в ячейках, определяющих Форму, Шаблон и единицу измерения на значения, соответствующие новому шаблону. Затем следует заполнить список показателей: номер раздела, номер строки и т.д. Для удобства пользователей написана процедура на VisualBasic, с помощью которой можно заполнить строки на листе «Показатели». Процедуру следует скопировать в Excel-файл нового шаблона из стандартных шаблонов, например, [Стандартный. Сведения о движении ЦБ и доходах 1-ЦБ], [Стандартный. Сведения о сост.расчетов 1-РП (срочн)], [Стандартный. Сведения о производст. и отгрузке П-1], [Стандартный. Осн.сведения о деятельности 1-предпр] или др. Теперь, чтобы добавить показатели из какой-либо таблицы нового шаблона в список на листе «Показатели», следует отметить часть таблицы так, чтобы левая верхняя ячейка совпала с ячейкой на пересечении столбца с кодами строк и строки с номерами столбцов, а правая нижняя ячейка ограничивала область показателей, потом по Alt_F8 вызвать макрос FillRegion, указать в открывшемся окне номер раздела, – и данные из отмеченного сектора таблицы попадут на лист «Показатели» начиная с первой незаполненной строки листа «Показатели».</span></p>
<p style="text-align: center; text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';"> </span><img src="pok6.jpg" width="911" height="702" alt="pok6" style="border:none" /></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Затем следует скорректировать лист «Показатели» - удалить строки с теми показателями, которые не выгружаются в таблицу [_Показатели архивных отчетов], для показателей, у которых единица измерения отличается от общей единицы измерения для шаблона, указанной во второй строке листа «Показатели», надо проставить единицу измерения в 8-м столбце соответствующей показателю строки.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Лист «Показатели» можно также использовать для автоматизации заполнения шаблона при создании отчета из пользовательской формы. Пример – форма [Стандартная. Сведения о движении ЦБ и доходах 1-ЦБ]. Перед заполнением &nbsp;шаблона открывается лист «Показатели», по нему заполняется массив с названиями показателей и их адресами в Excel-Книге (название показателя составляется по строго определенному правилу: «s»+Раздел+ «_» + Код строки + «_» + Графа, например, название s1_02_4 соответствует показателю раздела 1 на пересечении строки с кодом 02 и графы 4). Потом определяется запрос для сбора данных. Для каждого показателя из массива ищется колонка запроса, название которой совпадает с названием показателя, и если такая колонка найдена, ее значение попадает в шаблон по адресу, взятому в соответствующей строке листа «Параметры».</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px;"><span style="font-size: 12pt; font-weight: bold;">Проектирование запросов для составления бухгалтерской и статистической отчетности</span></p>
<p style="text-align: center; text-indent: 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Для составления отчетов бухгалтерской отчетности (&quot;Бухгалтерский баланс&quot;, &quot;Отчет о прибылях и убытках&quot;, &quot;Отчет о движении денежных средств&quot;), а также для статистических отчетов (формы П-1, П-3 и др.) необходимы:</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 71px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- шаблон отчета;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 71px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- запросы для извлечения данных из базы данных;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 71px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- пользовательская форма, в которой производится ввод параметров для запроса, инициируется его выполнение и осуществляется расстановка полученных данных (показателей) по надлежащим местам отчета.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Как правило, данными для отчетов (т.е. результатами выполнения запросов) являются:</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 71px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- сальдо по конкретным счетам бухучета на начало/конец периода;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 71px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- обороты по счетам/субсчетам (часто в корреспонденции с определенными счетами/субсчетами) за период;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 71px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- суммы (разности) этих сальдо или оборотов;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 71px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- значения тех же показателей за предыдущий период.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Таким образом, значения показателей зависят от конкретного плана счетов, в т.ч. от используемых субсчетов (&quot;прочих&quot; - в терминологии комплекса &quot;БУХта&quot;). </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Ранее при разработке запросов для выбора типа значения каждого показателя (дебетовое или кредитовое сальдо, обороты по дебету или кредиту) и списка счетов, по которым вычисляется сальдо или обороты, использовался универсальный инструмент &quot;SQL-алгоритм&quot;, что делало настройку запроса на конкретный план счетов довольно сложной, а скорость выполнения запроса - низкой.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Разработана и реализована принципиально новая схема настройки запросов для печати отчетов. Запросы строятся в соответствии с настройками полей запроса, которые содержатся &nbsp;в специальной таблице [_Настройка форм отчетности]. </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Для каждого отчета разрабатывается пользовательская форма, преобразующая введенные пользователем и хранящиеся в таблице настройки в последовательность SQL-предложений запроса (секция &quot;SQL-Before&quot;).</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Форма для настройки вызывается из форм для составления отчетов по кнопке «Редактор списка».</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Для одних отчетов достаточно настроить один запрос, для других – два и больше. Так, для отчета [Стандартный. Сведения о производст. и отгрузке П-1] необходимо настроить три разных запроса: [Запрос за отчетный месяц] – для заполнения графы 1, [Запрос за предыдущий месяц] – для заполнения графы 2 и [Запрос за месяц прошлого года] – для заполнения графы 3. В момент составления отчета перед вызовом запросов параметрам «Дата начала» и «Дата конца» автоматически присваиваются разные значения &nbsp;- для запроса за отчетный месяц это - отчетный месяц, указанный на форме, для запроса за предыдущий месяц – месяц, предшествующий отчетному, а для запроса за месяц прошлого года – соответствующий месяц прошлого года.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px; margin: 0px 0px 0px 47px;"><img src="pok7.jpg" width="550" height="435" alt="pok7" style="border:none" /></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Для каждого поля запроса указываются:</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- [Номер] – определяет название поля запроса, </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- [Тип сальдо] – определяет алгоритм расчета</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- [Запрос] – название запроса</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- [Код формы] – код формы отчета, для печати которого составлен запрос</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- [Минус] – признак проставляется, если значение поля следует сторнировать</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- [Список счетов, [Свертка счета], [Список корр. счетов], [Список субсчетов], [Доп. условие] – определяют параметры расчета</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">[Единица измерения] – единица измерения - делитель, на который делится значение поля перед тем, как записывается в отчет</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">[Округление] – определяет округление результата деления на единицу измерения</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Каждый настраиваемый запрос – это запрос по таблице [#Формы отчетности], он состоит из постоянной и изменяемой частей.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Постоянная часть добавляется разработчиком в секцию SQL-Before запроса, включает в себя объявление общих переменных: даты начала и конца периода, за который составляется отчет, единицу измерения и округление для показателей отчета. Этим переменным присваиваются значения, которые передаются из вызывающей пользовательской формы через глобальные переменные в VbSript запроса (примером такого запроса может служить запрос [Стандартный. Форма ПМ/1]).  </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">В постоянную часть включается также вызов процедур для предварительного заполнения вспомогательных таблиц, например, таблицы [#Сводные обороты]. Постоянная часть должны обязательно включать в себя строки</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">DECLARE</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">-- Настройка_1_начало --</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">-- Настройка_1_конец --</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">-- Настройка_2_начало --</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">-- Настройка_2_конец --</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Переменная часть формируется в момент сохранения запроса в форме [Настройка форм отчетности. Из режима печати отчета], при этом между строками «-- Настройка_1_начало --» и «-- Настройка_1_конец --» автоматически добавляются объявления переменных, их имена образуются добавлением к значению поля «Номер» в настройке префикса «@s». Между строками «-- Настройка_2_начало --» и «-- Настройка_2_конец --» - этим переменным присваиваются значения в зависимости от алгоритма и параметров расчета, определенных в настройке. При сохранении запроса в него также добавляются поля с названиями, соответствующими объявленным переменным, но без первого знака «@».</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Рассмотрим подробнее настройку полей запроса с разными типами значений.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">1. Если выбран тип «Дебетовое сальдо», «Кредитовое сальдо», «Свернутое сальдо», «Дебет» или «Кредит», следует заполнить поля [Список счетов], [Свертка счета] (и, возможно, [Список корр. счетов], [Список субсчетов], [Доп. условие]), которые определяют параметры вычисления сальдо и оборотов.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px; margin: 0px 0px 0px 47px;"><img src="pok8.jpg" width="605" height="350" alt="pok8" style="border:none" /></p>
<p style="text-align: center; text-indent: 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">При этом в постоянную часть настройки запроса следует включить вызов процедуры для заполнения таблицы [#Сводные обороты]:</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">TRUNCATE TABLE [#Сводные обороты]</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">EXEC dbo.[Сводные обороты] @BegDate, @EndDate, @Kontora</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Результат – поле запроса объявляется как SQL-число и принимает числовое значение в соответствии с настройкой – сальдо или оборот по счету.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">2. Если значение Типа равно «Формула» – в поле «Формула» следует указать числовое значение, поле запроса объявляется как SQL-число и принимает это числовое значение.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">3. Если значение Типа равно «Не используется» или «Вычисляется в отчете», то поле запроса объявляется как SQL-число и принимает числовое значение ноль.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">4. Если значение Типа &nbsp;равно «Вычисляется в запросе», то поле запроса объявляется как SQL-число, но значение ему не присваивается, его должен присвоить разработчик в постоянной части настройки запроса.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">5. Если для поля запроса выбран тип, равный «Показатели из отчетов», то в карточке настройки поля запроса следует отметить в Списке показателей те, которые участвуют в формировании значения поля.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px;"><img src="pok9.jpg" width="844" height="459" alt="pok9" style="border:none" /></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">В Список показателей попадают все показатели из таблицы [_Показатели архивных отчетов], сгруппированные по названию показателя, которое формируется как [ПМ рзд.2 стр.06 грф.4], где ПМ – корд формы отчетности, 2 – номер раздела, 06 – код строки, 4 – номер графы. Если в списке отмечено несколько показателей, то по умолчанию они будут переведены в числовые значения и просуммированы. Знаки между показателями в сформированном поле «Показатели» в карточке редактирования можно менять. В запросе переменная, соответствующая этому полю, приравнивается к значению функции [_Показатели из архивных отчетов. Строка] (или к сумме значений функции [_Показатели из архивных отчетов. Число], если складываются несколько показателей). Эти функции выбирают из таблицы [_Показатели архивных отчетов] значения по коду формы, датам начала и конца, номерам раздела, строки и графы по текущему юр.лицу, числовые значения при этом умножаются на единицу измерения, указанную в соответствующем поле таблицы (поскольку единица измерения для показателя, хранящегося в таблице, может не совпадать с единицей измерения в отчете, который составляется по настраиваемому запросу). В запросе вычисленное значение поля делится на единицу измерения и округляется, при этом значение делителя и округления берутся из настройки поля запроса, если же такой настройки нет (т.е. поле «Единица измерения» равно нулю, а поле «Округление» не заполнено), то делитель и округление берутся из значений, указанных напрямую в форме печати отчета для всего шаблона. Так реализована возможность вывода в текущий отчет данных другого отчета, показатели которого сохранены в таблице [_Показатели архивных отчетов]. Поле запроса объявляется как SQL-строка и принимает строковое значение, в которое переводится результат расчетов.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">6. SQL-Число - в поле «SQL или значение» следует указать число или SQL-запрос, результатом которого является число. Поле запроса объявляется как SQL-число и принимает значение, соответствующее указанному числу или результату SQL-запроса.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">7. SQL-Строка – в поле «SQL или значение» следует указать строку в апострофах или SQL-запрос, результатом которого является строка. Поле запроса объявляется как SQL-строка и принимает строковое значение, соответствующее результату SQL-запроса, или указанной строке.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Настройку полей запросов можно рассмотреть на примере запросов к отчету [Стандартный. Сведения о затратах на продукцию 5-З]. На экране формы перед печатью отчета следует нажать кнопку в левом нижнем углу и перейти к настройке полей запросов.  </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px;"><img src="pok10.jpg" width="665" height="402" alt="pok10" style="border:none" /></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Надо отметить, что к моменту настройки полей запроса, в списке запросов должен существовать запрос, который настраивается – его должен создать разработчик, в запросе должна присутствовать обязательная часть, VBScript, заполняющий в соответствии со значениями глобальных переменных общие параметры - начало и конец периода, единицу измерения и округление. При этом для отчета [Стандартный. Сведения о затратах на продукцию 5-З] имя запроса формируется следующим образом: «Стандартный. Форма 5-З/1», где «Стандартный. Форма» - общий префикс для всех запросов, «5-З» - код формы, «1» - для запросов за отчетный период, «2» - для запросов за соответствующий период прошлого года, «3» - для запросов за предыдущий месяц.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Сначала следует настроить запрос за отчетный период – нажать соответствующую кнопку на экране. Обычно поля запросов за отчетный период настраиваются по проводкам, т.е. в соответствии с пунктом 1. После того, как поля запроса добавлены в настройку, следует сохранить запрос, нажав кнопку «Сохранить». </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px;"><img src="pok11.jpg" width="558" height="304" alt="pok11" style="border:none" /></p>
<p style="text-align: center; text-indent: 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Затем можно перейти к настройке запроса за соответствующий период предыдущего года, обычно поля таких запросов настраиваются по таблице [_Показатели архивных отчетов], т.е. им присваивается «Тип сальдо», равный «Показатели из отчетов».</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px;"><img src="pok12.jpg" width="612" height="306" alt="pok12" style="border:none" /></p>
<p style="text-align: center; text-indent: 0px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Таким образом, при составлении отчета данные за отчетный период будут браться по оборотам отчетного периода, а данные за соответствующий период прошлого года – из таблицы [_Показатели архивных отчетов], куда они были записаны после создания отчета за период прошлого года. Если же отчетов за прошлый год нет, то запрос за период прошлого год следует настроить так же, как и запрос за отчетный период – по проводкам, и тогда данные за период прошлого года будут собираться по оборотам прошлого года.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-weight: bold;">Дополнение для версии 2.118 и выше.</span></p>
<p style="text-align: center; text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">В соответствии с Приказом Минфина России от 02.07.2010 N 66н утверждены новые формы «Бухгалтерского баланса» и «Отчета о прибылях и убытках». </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">В таблицах [_Настройка форм отчетности] и [_Показатели из архивных отчетов] новая форма «Бухгалтерского баланса» имеет код &nbsp;Ф1_2011, новая форма «Отчета о прибылях и убытках» - код &nbsp;Ф2_2011.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Существенные отличия в настройке этих отчетов по сравнению с предыдущими версиями заключаются в следующем: </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- добавлены настройки запросов за предыдущий период, </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- добавлена возможность сохранения рассчитанных показателей в таблицу</span><span style="font-size: 12pt; font-family: 'Times New Roman'; font-weight: bold;"> </span><span style="font-size: 12pt; font-family: 'Times New Roman';">[_Показатели из архивных отчетов] и их дальнейшего использования для настройки запросов за предыдущие периоды.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Для составления «Бухгалтерского баланса» необходимо настроить два запроса:</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- за отчетный период,</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- за предыдущие два года.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Для составления «Отчета о прибылях и убытках» необходимо также настроить два запроса:</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- за отчетный период,</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- за соответствующий период предыдущего года. </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 46px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Запросы за предыдущие годы можно рассчитывать по сальдо оборотам, выбрав в карточке настройки для параметра «Тип сальдо» &nbsp;значения &nbsp;«Дебетовое Сальдо», «Кредитовое сальдо», «Свернутое сальдо», для параметра «Тип оборотов» - значения &nbsp;«Дебет», «Кредит», а можно брать из таблицы [_Показатели из архивных отчетов] (если она содержит нужные показатели за предыдущие годы), в этом случае для параметра «Тип сальдо/оборотов» указывается значение «Показатели из отчетов». При этом для настройки &nbsp;«Бухгалтерского баланса» из таблицы [_Показатели из архивных отчетов] &nbsp;по каждой строке выбираются значения [Ф1_2011 рзд.1 стр.&lt;номер строки&gt; грф.1] для формы Ф1_2011, а для «Отчета о прибылях и убытках» по каждой строке выбираются значения [Ф1_2011 рзд.2 стр.&lt;номер строки&gt; грф.1] для формы Ф2_2011. </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: center; text-indent: 0px; margin: 0px 0px 0px 47px;"><span style="font-size: 12pt; font-weight: bold;">Дополнение для версии 2.119 и выше.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Изменен «Отчет о движении денежных средств». В таблицах [_Настройка форм отчетности] и [_Показатели из архивных отчетов] новая форма «Отчет о движении денежных средств» имеет код &nbsp;Ф4_2011.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">По сравнению с предыдущими версиями в настройку отчета: </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- добавлены настройки запросов за предыдущий период; т.о. перед составлением отчета необходимо настроить два запроса: за отчетный период, и за соответствующий период предыдущего года; </span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- добавлена возможность сохранения рассчитанных показателей в таблицу [_Показатели из архивных отчетов] и их дальнейшего использования для настройки запросов за предыдущие периоды.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">Запросы за предыдущие годы можно рассчитывать по сальдо оборотам, выбрав в карточке настройки для параметра «Тип» значения &nbsp;«Дебет», «Кредит», а можно брать из таблицы [_Показатели из архивных отчетов] (если она содержит нужные показатели за предыдущие годы), в этом случае для параметра «Тип» указывается значение «Показатели из отчетов». При этом в случае настройки &nbsp;«Отчета о движении денежных средств» по каждой строке выбираются значения [Ф4_2011 рзд. стр.&lt;номер строки&gt; грф.1] для формы с кодом Ф4_2011.</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- &nbsp;Значение «Формула» параметра «Тип» позволяет использовать для настройки одних показателей значения других показателей. Так например, если в поле «Тип» установить значение «Формула», для показателя «4100», который является суммой показателей «4110» и «4120», можно указать значение «s4110+s4120».</span></p>
<p style="text-indent: 0px; margin: 0px 0px 0px 59px;"><span style="font-size: 12pt; font-family: 'Times New Roman';">- &nbsp;Можно комбинировать типы настроек и фильтров в пределах одного показателя. Так, если требуется для строки с кодом «4121» собрать данные по Дебету счетов 60, 71, 76 и по Кредиту счета 60, заводится два показателя: один - «4121а» со значением «Дебет» в поле «Тип» и значениями «60,71,76» в поле «Список счетов», второй - «4121b» со значением «Кредит» в поле «Тип» и значением «60» в поле «Список счетов».</span></p>
<p style="text-indent: 0px;"><span style="color: #000000;">&nbsp;</span></p>

</td></tr></table>

</body>
</html>
